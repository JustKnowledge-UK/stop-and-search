---
jupyter: python3
title: "Stop and Search in Haringey: April 23 to April 24"
format: 
    html:
        embed-resources: true
        echo: false
---


```{python}
import pandas as pd
import numpy as np
import geopandas as gpd
import os
import glob
from shapely.geometry import Point
import matplotlib.pyplot as plt
import contextily as cx
```

```{python lad-boundaries}
# LAD boundaries
pattern = os.path.join('..','data','LAD_23_boundaries', '*.shp')
files = glob.glob(pattern)
lad_gpd = gpd.read_file(files[0])
# make colnames lowercase
lad_gpd.columns = [x.lower() for x in lad_gpd.columns]

```

```{python}
pattern = os.path.join('..','data','*haringey*.csv')
files = glob.glob(pattern)
stops_data = pd.read_csv(files[0])

geometry = [Point(xy) for xy in zip(stops_data["location.longitude"], stops_data["location.latitude"])]
# crs = {'init': 'epsg:4326'}
stops_gpd = gpd.GeoDataFrame(stops_data, crs="EPSG:4326", geometry=geometry)
stops_gpd = stops_gpd.to_crs("EPSG:27700")
```

The plot below shows the unique locations of all stops in Haringey between Apr 1 2023 and Mar 31 2024, by self-defined ethnicity.

```{python}
la = 'Haringey'
fig, ax = plt.subplots(figsize=[20,20])
temp_lad_gpd = lad_gpd[lad_gpd['lad23nm']==la]

temp_lad_gpd.boundary.plot(ax=ax, edgecolor="black")
stops_gpd.plot(column='self_defined_ethnicity',ax=ax, legend=True)
cx.add_basemap(ax, crs = stops_gpd.crs, source=cx.providers.OpenStreetMap.Mapnik)

ax.set_axis_off()


```


